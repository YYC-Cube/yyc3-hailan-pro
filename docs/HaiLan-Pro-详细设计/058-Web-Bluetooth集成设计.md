---
file: 058-Web-Bluetoothé›†æˆè®¾è®¡.md
description: HaiLan Pro æ™ºèƒ½ç¡¬ä»¶è®¾å¤‡é€šè¿‡Web Bluetooth APIè¿æ¥ä¸æ§åˆ¶çš„è¯¦ç»†è®¾è®¡
author: YanYuCloudCube Team
version: v1.0.0
created: 2026-01-26
updated: 2026-01-26
status: published
tags:
  - HaiLan-Pro-è¯¦ç»†è®¾è®¡,[]
---

> ***YanYuCloudCube***
> **æ ‡è¯­**ï¼šè¨€å¯è±¡é™ | è¯­æ¢æœªæ¥
> ***Words Initiate Quadrants, Language Serves as Core for the Future***
> **æ ‡è¯­**ï¼šä¸‡è±¡å½’å…ƒäºäº‘æ¢ | æ·±æ ˆæ™ºå¯æ–°çºªå…ƒ
> ***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***

---

# 058 Web Bluetoothé›†æˆè®¾è®¡

## æ¦‚è¿°

æœ¬æ–‡æ¡£è¯¦ç»†æè¿°HaiLan Pro-HaiLan-Pro-è¯¦ç»†è®¾è®¡-Web Bluetoothé›†æˆè®¾è®¡ç›¸å…³å†…å®¹ï¼Œç¡®ä¿é¡¹ç›®æŒ‰ç…§YYCÂ³æ ‡å‡†è§„èŒƒè¿›è¡Œå¼€å‘å’Œå®æ–½ã€‚

## æ ¸å¿ƒå†…å®¹

### 1. èƒŒæ™¯ä¸ç›®æ ‡

#### 1.1 é¡¹ç›®èƒŒæ™¯
HaiLan Pro (æµ·è“) æ˜¯æ–°ä¸€ä»£é«˜ç«¯ã€ç§å¯†ã€æ™ºèƒ½çš„æƒ…è¶£å¥åº·ç”Ÿæ´»ç®¡ç†å¹³å°ã€‚é¡¹ç›®åŸºäºã€Œäº”é«˜äº”æ ‡äº”åŒ–ã€ç†å¿µï¼Œé€šè¿‡ PWA æŠ€æœ¯ç»“åˆ AI æ™ºèƒ½è¾…åŠ©ä¸ç‰©è”ç½‘ï¼Œä¸ºç”¨æˆ·æä¾›ä»ç”Ÿç†å¥åº·åˆ°å¿ƒç†æ„‰æ‚¦çš„å…¨æ–¹ä½è§£å†³æ–¹æ¡ˆã€‚

#### 1.2 é¡¹ç›®æ„¿æ™¯
æ‰“é€ æè‡´éšç§ã€æ™ºèƒ½é™ªä¼´ã€å“è´¨åˆè§„ã€å…¨åœºæ™¯è¦†ç›–çš„æƒ…è¶£å¥åº·ç”Ÿæ´»ç®¡ç†å¹³å°ï¼Œä¸ºç”¨æˆ·æä¾›å®‰å…¨ã€ä¸“ä¸šã€é«˜ç«¯çš„å¥åº·ç”Ÿæ´»ä½“éªŒã€‚

#### 1.3 æ ¸å¿ƒä»·å€¼ä¸»å¼ 
- **æè‡´éšç§**ï¼šåŒé‡åŠ å¯†ã€éšç§æµè§ˆæ¨¡å¼åŠä¼ªè£…å‘è´§æœºåˆ¶
- **æ™ºèƒ½é™ªä¼´**ï¼šåŸºäº LLM çš„ AI æƒ…æ„Ÿä¸ç”Ÿç†å¥åº·é¡¾é—®
- **å“è´¨åˆè§„**ï¼šåŒ»ç–—çº§æ ‡å‡†å•†å“ï¼Œé«˜ç«¯"æµ·è“è“"è§†è§‰è°ƒæ€§
- **å…¨åœºæ™¯è¦†ç›–**ï¼šPWA ç«¯æ”¯æŒç¦»çº¿æµè§ˆã€æ¡Œé¢å®‰è£…åŠæ— ç¼æ¨é€

#### 1.4 æ–‡æ¡£ç›®æ ‡
- è§„èŒƒWeb Bluetoothé›†æˆè®¾è®¡ç›¸å…³çš„ä¸šåŠ¡æ ‡å‡†ä¸æŠ€æœ¯è½åœ°è¦æ±‚
- ä¸ºé¡¹ç›®ç›¸å…³äººå‘˜æä¾›æ¸…æ™°çš„å‚è€ƒä¾æ®
- ä¿éšœç›¸å…³æ¨¡å—å¼€å‘ã€å®æ–½ã€è¿ç»´çš„ä¸€è‡´æ€§ä¸è§„èŒƒæ€§

### 2. è®¾è®¡åŸåˆ™

#### 2.1 äº”é«˜åŸåˆ™
- **é«˜å¯ç”¨æ€§**ï¼šç¡®ä¿ç³»ç»Ÿ7x24å°æ—¶ç¨³å®šè¿è¡Œï¼Œæ”¯æŒPWAç¦»çº¿èƒ½åŠ›
- **é«˜æ€§èƒ½**ï¼šä¼˜åŒ–å“åº”æ—¶é—´å’Œå¤„ç†èƒ½åŠ›ï¼Œæ”¯æŒé«˜å¹¶å‘è®¿é—®
- **é«˜å®‰å…¨æ€§**ï¼šä¿æŠ¤ç”¨æˆ·æ•°æ®å’Œéšç§å®‰å…¨ï¼ŒåŒé‡åŠ å¯†æœºåˆ¶
- **é«˜æ‰©å±•æ€§**ï¼šæ”¯æŒä¸šåŠ¡å¿«é€Ÿæ‰©å±•ï¼Œå¾®æœåŠ¡æ¶æ„è®¾è®¡
- **é«˜å¯ç»´æŠ¤æ€§**ï¼šä¾¿äºåç»­ç»´æŠ¤å’Œå‡çº§ï¼Œæ¨¡å—åŒ–è®¾è®¡

#### 2.2 äº”æ ‡ä½“ç³»
- **æ ‡å‡†åŒ–**ï¼šç»Ÿä¸€çš„æŠ€æœ¯å’Œæµç¨‹æ ‡å‡†
- **è§„èŒƒåŒ–**ï¼šä¸¥æ ¼çš„å¼€å‘å’Œç®¡ç†è§„èŒƒ
- **è‡ªåŠ¨åŒ–**ï¼šæé«˜å¼€å‘æ•ˆç‡å’Œè´¨é‡ï¼ŒCI/CDè‡ªåŠ¨åŒ–
- **æ™ºèƒ½åŒ–**ï¼šåˆ©ç”¨AIæŠ€æœ¯æå‡èƒ½åŠ›ï¼ŒLLMæ™ºèƒ½é¡¾é—®
- **å¯è§†åŒ–**ï¼šç›´è§‚çš„ç›‘æ§å’Œç®¡ç†ç•Œé¢

#### 2.3 äº”åŒ–æ¶æ„
- **æµç¨‹åŒ–**ï¼šæ ‡å‡†åŒ–çš„å¼€å‘æµç¨‹
- **æ–‡æ¡£åŒ–**ï¼šå®Œå–„çš„æ–‡æ¡£ä½“ç³»
- **å·¥å…·åŒ–**ï¼šé«˜æ•ˆçš„å¼€å‘å·¥å…·é“¾
- **æ•°å­—åŒ–**ï¼šæ•°æ®é©±åŠ¨çš„å†³ç­–
- **ç”Ÿæ€åŒ–**ï¼šå¼€æ”¾çš„ç”Ÿæ€ç³»ç»Ÿ

### 3. Web Bluetoothé›†æˆè®¾è®¡

#### 3.1 Web Bluetoothæ¶æ„

##### 3.1.1 BLEè®¾å¤‡é€šä¿¡æ¶æ„

```typescript
// Web Bluetoothæ¶æ„å®šä¹‰
interface WebBluetoothArchitecture {
  // æµè§ˆå™¨ä¸BLEè®¾å¤‡é€šä¿¡
  communication: {
    browser: {
      api: 'Web Bluetooth API';
      requirement: 'HTTPSç¯å¢ƒ';
      supportCheck: 'navigator.bluetooth'
    };
    device: {
      protocol: 'BLE (Bluetooth Low Energy)';
      version: 'BLE 4.0+';
      pairing: 'é…å¯¹åè‡ªåŠ¨è¿æ¥'
    };
    security: {
      encryption: 'AES-CCM';
      bonding: 'è®¾å¤‡ç»‘å®š';
      authorization: 'ç”¨æˆ·æˆæƒ'
    };
  };

  // GATT (Generic Attribute Profile) å±‚çº§
  gatt: {
    device: 'BLEè®¾å¤‡';
    services: 'æœåŠ¡é›†åˆ';
    characteristics: 'ç‰¹å¾å€¼é›†åˆ';
    descriptors: 'æè¿°ç¬¦';
  };

  // é€šä¿¡æµç¨‹
  flow: [
    '1. æ£€æŸ¥æµè§ˆå™¨æ”¯æŒ',
    '2. è¯·æ±‚è®¾å¤‡æ‰«æ',
    '3. é€‰æ‹©è®¾å¤‡è¿æ¥',
    '4. å‘ç°GATTæœåŠ¡',
    '5. è·å–ç‰¹å¾å€¼',
    '6. è¯»å†™/é€šçŸ¥æ•°æ®',
    '7. æ–­å¼€è¿æ¥'
  ];
}
```

##### 3.1.2 æ”¯æŒçš„è®¾å¤‡ç±»å‹

```typescript
// æ”¯æŒçš„IoTè®¾å¤‡ç±»å‹
interface SupportedIoTDevices {
  // æ™ºèƒ½æŒ‰æ‘©è®¾å¤‡
  massageDevices: {
    category: 'æŒ‰æ‘©ä»ª';
    examples: ['é¢ˆæ¤æŒ‰æ‘©ä»ª', 'è¶³éƒ¨æŒ‰æ‘©å™¨', 'çœ¼éƒ¨æŒ‰æ‘©ä»ª'];
    services: {
      control: 'æŒ‰æ‘©æ§åˆ¶æœåŠ¡',
      status: 'çŠ¶æ€åé¦ˆæœåŠ¡',
      battery: 'ç”µæ± æœåŠ¡',
      deviceInfo: 'è®¾å¤‡ä¿¡æ¯æœåŠ¡'
    };
  };

  // å¥åº·ç›‘æµ‹è®¾å¤‡
  healthDevices: {
    category: 'å¥åº·ç›‘æµ‹';
    examples: ['æ™ºèƒ½æ‰‹ç¯', 'å¥åº·ç›‘æµ‹ä»ª', 'ä½“è„‚ç§¤'];
    services: {
      heartRate: 'å¿ƒç‡æœåŠ¡',
      bloodPressure: 'è¡€å‹æœåŠ¡',
      bodyComposition: 'ä½“ç»„æˆæœåŠ¡',
      activity: 'è¿åŠ¨æ•°æ®æœåŠ¡'
    };
  };

  // æ™ºèƒ½ç©å…·
  smartToys: {
    category: 'æ™ºèƒ½ç¡¬ä»¶';
    examples: ['äº’åŠ¨ç©å…·', 'æ§åˆ¶è®¾å¤‡'];
    services: {
      control: 'æ§åˆ¶æœåŠ¡',
      vibration: 'æŒ¯åŠ¨æ¨¡å¼æœåŠ¡',
      sensor: 'ä¼ æ„Ÿå™¨æ•°æ®æœåŠ¡'
    };
  };
}
```

#### 3.2 è®¾å¤‡è¿æ¥å®ç°

##### 3.2.1 è“ç‰™è®¾å¤‡æœåŠ¡

```typescript
// Web BluetoothæœåŠ¡å®ç°
// src/core/services/bluetooth.service.ts
import { Injectable } from '@nestjs/common';
import { EventEmitter } from 'events';

@Injectable()
export class BluetoothService extends EventEmitter {
  private device: BluetoothDevice | null = null;
  private server: BluetoothRemoteGATTServer | null = null;
  private characteristics: Map<string, BluetoothRemoteGATTCharacteristic> = new Map();

  /**
   * æ£€æŸ¥æµè§ˆå™¨æ”¯æŒ
   */
  isSupported(): boolean {
    return 'bluetooth' in navigator;
  }

  /**
   * æ‰«æå¹¶è¿æ¥è®¾å¤‡
   */
  async connect(options: ConnectOptions): Promise<BluetoothDevice> {
    if (!this.isSupported()) {
      throw new Error('æµè§ˆå™¨ä¸æ”¯æŒWeb Bluetooth API');
    }

    try {
      // 1. è¯·æ±‚è®¾å¤‡
      this.device = await navigator.bluetooth.requestDevice({
        filters: options.filters || [],
        optionalServices: options.optionalServices || [],
        acceptAllDevices: options.acceptAllDevices || false
      });

      console.log('è®¾å¤‡å·²é€‰æ‹©:', this.device.name);

      // 2. ç›‘å¬è®¾å¤‡æ–­å¼€äº‹ä»¶
      this.device.addEventListener('gattserverdisconnected', this.handleDisconnect.bind(this));

      // 3. è¿æ¥GATTæœåŠ¡å™¨
      this.server = await this.device.gatt!.connect();
      console.log('GATTæœåŠ¡å™¨å·²è¿æ¥');

      // 4. å‘ç°æœåŠ¡
      await this.discoverServices(options.services || []);

      // 5. è·å–ç‰¹å¾å€¼
      await this.getCharacteristics(options.characteristics || []);

      this.emit('connected', this.device);
      return this.device;

    } catch (error) {
      console.error('è®¾å¤‡è¿æ¥å¤±è´¥:', error);
      throw error;
    }
  }

  /**
   * æ–­å¼€è®¾å¤‡è¿æ¥
   */
  async disconnect(): Promise<void> {
    if (this.device && this.device.gatt?.connected) {
      await this.device.gatt.disconnect();
      this.device = null;
      this.server = null;
      this.characteristics.clear();
      this.emit('disconnected');
    }
  }

  /**
   * å‘ç°æœåŠ¡
   */
  private async discoverServices(serviceUuids: string[]): Promise<void> {
    if (!this.server) {
      throw new Error('GATTæœåŠ¡å™¨æœªè¿æ¥');
    }

    const services = await this.server.getPrimaryServices();

    console.log('å‘ç°æœåŠ¡æ•°é‡:', services.length);

    for (const service of services) {
      console.log('æœåŠ¡UUID:', service.uuid);
    }
  }

  /**
   * è·å–ç‰¹å¾å€¼
   */
  private async getCharacteristics(characteristicConfigs: CharacteristicConfig[]): Promise<void> {
    for (const config of characteristicConfigs) {
      const service = await this.server!.getPrimaryService(config.service);
      const characteristic = await service.getCharacteristic(config.uuid);

      this.characteristics.set(config.name, characteristic);

      // å¦‚æœéœ€è¦é€šçŸ¥ï¼Œå¯ç”¨é€šçŸ¥
      if (config.notify) {
        await characteristic.startNotifications();
        characteristic.addEventListener('characteristicvaluechanged', (event: any) => {
          this.handleCharacteristicChanged(config.name, event.target.value);
        });
      }
    }
  }

  /**
   * è¯»å–ç‰¹å¾å€¼
   */
  async readCharacteristic(name: string): Promise<DataView> {
    const characteristic = this.characteristics.get(name);
    if (!characteristic) {
      throw new Error(`ç‰¹å¾å€¼ ${name} ä¸å­˜åœ¨`);
    }

    const value = await characteristic.readValue();
    return value;
  }

  /**
   * å†™å…¥ç‰¹å¾å€¼
   */
  async writeCharacteristic(name: string, value: BufferSource): Promise<void> {
    const characteristic = this.characteristics.get(name);
    if (!characteristic) {
      throw new Error(`ç‰¹å¾å€¼ ${name} ä¸å­˜åœ¨`);
    }

    await characteristic.writeValue(value);
  }

  /**
   * å¤„ç†ç‰¹å¾å€¼å˜åŒ–
   */
  private handleCharacteristicChanged(name: string, value: DataView): void {
    this.emit('characteristicChanged', {
      characteristic: name,
      value: value,
      timestamp: Date.now()
    });
  }

  /**
   * å¤„ç†è®¾å¤‡æ–­å¼€
   */
  private handleDisconnect(): void {
    console.log('è®¾å¤‡å·²æ–­å¼€');
    this.emit('disconnected');
    this.device = null;
    this.server = null;
    this.characteristics.clear();
  }
}

// ç±»å‹å®šä¹‰
interface ConnectOptions {
  filters?: BluetoothLEScanFilter[];
  optionalServices?: string[];
  services?: string[];
  characteristics?: CharacteristicConfig[];
  acceptAllDevices?: boolean;
}

interface CharacteristicConfig {
  name: string;
  service: string;
  uuid: string;
  notify?: boolean;
}
```

##### 3.2.2 è®¾å¤‡æ§åˆ¶æœåŠ¡

```typescript
// IoTè®¾å¤‡æ§åˆ¶æœåŠ¡
// src/platforms/h5/services/iot-device.service.ts
import { Injectable } from '@angular/core';
import { BluetoothService } from './bluetooth.service';

@Injectable()
export class IoTDeviceService {
  constructor(private bluetooth: BluetoothService) {}

  /**
   * è¿æ¥æŒ‰æ‘©ä»ª
   */
  async connectMassageDevice(): Promise<void> {
    await this.bluetooth.connect({
      filters: [{ namePrefix: 'HailanMassage' }],
      optionalServices: ['massage_service', 'battery_service', 'device_info'],
      services: ['massage_service', 'battery_service'],
      characteristics: [
        { name: 'control', service: 'massage_service', uuid: '0xA001', notify: true },
        { name: 'status', service: 'massage_service', uuid: '0xA002', notify: true },
        { name: 'battery', service: 'battery_service', uuid: '0xB001', notify: true }
      ]
    });
  }

  /**
   * æ§åˆ¶æŒ‰æ‘©ä»ª
   */
  async controlMassage(options: MassageControlOptions): Promise<void> {
    const command = this.buildMassageCommand(options);
    await this.bluetooth.writeCharacteristic('control', command);
  }

  /**
   * è¯»å–è®¾å¤‡çŠ¶æ€
   */
  async getDeviceStatus(): Promise<DeviceStatus> {
    const value = await this.bluetooth.readCharacteristic('status');
    return this.parseStatus(value);
  }

  /**
   * è¯»å–ç”µæ± ç”µé‡
   */
  async getBatteryLevel(): Promise<number> {
    const value = await this.bluetooth.readCharacteristic('battery');
    return value.getUint8(0);
  }

  /**
   * æ„å»ºæ§åˆ¶å‘½ä»¤
   */
  private buildMassageCommand(options: MassageControlOptions): Uint8Array {
    const buffer = new ArrayBuffer(6);
    const view = new DataView(buffer);

    view.setUint8(0, 0xAA);      // å¸§å¤´
    view.setUint8(1, options.mode);    // æ¨¡å¼
    view.setUint8(2, options.level);   // å¼ºåº¦ 0-10
    view.setUint16(3, options.duration); // æ—¶é•¿(åˆ†é’Ÿ)
    view.setUint8(5, 0x55);      // æ ¡éªŒå’Œ

    return new Uint8Array(buffer);
  }

  /**
   * è§£æè®¾å¤‡çŠ¶æ€
   */
  private parseStatus(value: DataView): DeviceStatus {
    return {
      power: value.getUint8(0) === 0x01,
      mode: value.getUint8(1),
      level: value.getUint8(2),
      duration: value.getUint16(3),
      temperature: value.getUint8(5) / 10
    };
  }
}

// ç±»å‹å®šä¹‰
interface MassageControlOptions {
  mode: number;      // æ¨¡å¼ 0-5
  level: number;     // å¼ºåº¦ 0-10
  duration: number;  // æ—¶é•¿(åˆ†é’Ÿ)
}

interface DeviceStatus {
  power: boolean;
  mode: number;
  level: number;
  duration: number;
  temperature: number;
}
```

#### 3.3 è®¾å¤‡æ§åˆ¶ç•Œé¢

##### 3.3.1 è®¾å¤‡åˆ—è¡¨é¡µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† æˆ‘çš„è®¾å¤‡                                    [+ æ·»åŠ è®¾å¤‡]      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  å·²ç»‘å®šè®¾å¤‡ (2)                                                  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ“± æ™ºèƒ½é¢ˆæ¤æŒ‰æ‘©ä»ª HL-001                           â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                                     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  ç”µé‡: 85% | çŠ¶æ€: å·²è¿æ¥ | ä¿¡å·: å¼º                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                                     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  [æ§åˆ¶] [è®¾ç½®] [è§£ç»‘]                              â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚ âŒš æ™ºèƒ½å¥åº·ç›‘æµ‹æ‰‹ç¯ HL-002                          â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                                     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  ç”µé‡: 45% | çŠ¶æ€: å·²è¿æ¥ | ä¿¡å·: ä¸­                 â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                                     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  [æ•°æ®] [è®¾ç½®] [è§£ç»‘]                              â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  å…¶ä»–è®¾å¤‡                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚  â”‚
â”‚  â”‚  â”‚ ğŸ” æœç´¢é™„è¿‘çš„è®¾å¤‡...                                â”‚   â”‚  â”‚
â”‚  â”‚  â”‚                                                     â”‚   â”‚  â”‚
â”‚  â”‚  â”‚  [å¼€å§‹æ‰«æ]                                         â”‚   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  ğŸ  é¦–é¡µ    ğŸ“‚ åˆ†ç±»    ğŸ¤– AIåŠ©æ‰‹    ğŸ›’ è´­ç‰©è½¦    ğŸ‘¤ æˆ‘çš„       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

##### 3.3.2 è®¾å¤‡æ§åˆ¶é¡µ

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  â† æ™ºèƒ½é¢ˆæ¤æŒ‰æ‘©ä»ª HL-001                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  âš¡ ç”µé‡: 85%                                        â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  è¿æ¥çŠ¶æ€: â— å·²è¿æ¥                                 â”‚  â”‚  â”‚
â”‚  â”‚  â”‚                                                     â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  å½“å‰æ¨¡å¼: æŒ‰æ‘©æ¨¡å¼                                  â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  å½“å‰å¼ºåº¦: 5æ¡£                                      â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  å‰©ä½™æ—¶é—´: 15åˆ†é’Ÿ                                    â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  æ¨¡å¼é€‰æ‹©                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚  â”‚  æŒ‰æ‘©    â”‚ â”‚ æ•²æ‰“    â”‚ â”‚ æ‰æ‰    â”‚ â”‚ è‡ªåŠ¨    â”‚          â”‚
â”‚  â”‚  æ¨¡å¼     â”‚ â”‚ æ¨¡å¼     â”‚ â”‚ æ¨¡å¼     â”‚ â”‚ æ¨¡å¼     â”‚          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
â”‚                                                                  â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  å¼ºåº¦è°ƒèŠ‚                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚  â”‚
â”‚  â”‚  1        2        3        4        5                   â”‚  â”‚
â”‚  â”‚  â”â”â”â”â”â”â”â”â—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚  â”‚
â”‚  â”‚  å¼± â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ å¼º    â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  å®šæ—¶è®¾ç½®                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  æ—¶é•¿: [15â–¼] åˆ†é’Ÿ                                         â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚
â”‚  â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚  5  â”‚  â”‚ 10  â”‚  â”‚ 15  â”‚  â”‚ 20  â”‚              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â”‚ åˆ†  â”‚  â”‚ åˆ†  â”‚  â”‚ åˆ†  â”‚  â”‚ åˆ†  â”‚              â”‚  â”‚  â”‚
â”‚  â”‚  â”‚  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”˜              â”‚  â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  åŠ çƒ­åŠŸèƒ½                                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  â—‹ å¼€å¯åŠ çƒ­  â— å…³é—­åŠ çƒ­                                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                                  â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                          â”‚
â”‚  â”‚     æš‚åœ       â”‚  â”‚     å¯åŠ¨       â”‚                          â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                          â”‚
â”‚                                                                  â”‚
â”‚  â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”  â”‚
â”‚  [å®šæ—¶é¢„çº¦]  [ä½¿ç”¨è®°å½•]  [è®¾å¤‡è®¾ç½®]                            â”‚
â”‚                                                                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### 3.4 æ•°æ®åŒæ­¥å®ç°

##### 3.4.1 æ•°æ®åŒæ­¥æœåŠ¡

```typescript
// è®¾å¤‡æ•°æ®åŒæ­¥æœåŠ¡
// src/core/services/device-sync.service.ts
import { Injectable } from '@nestjs/common';

@Injectable()
export class DeviceSyncService {
  private syncQueue: SyncItem[] = [];

  /**
   * æ·»åŠ åŒæ­¥ä»»åŠ¡
   */
  addSyncTask(deviceId: string, data: any): void {
    this.syncQueue.push({
      deviceId,
      data,
      timestamp: Date.now(),
      synced: false
    });
  }

  /**
   * æ‰§è¡ŒåŒæ­¥
   */
  async sync(): Promise<void> {
    const pendingItems = this.syncQueue.filter(item => !item.synced);

    for (const item of pendingItems) {
      try {
        await this.syncToDevice(item);
        await this.syncToCloud(item);
        item.synced = true;
      } catch (error) {
        console.error('åŒæ­¥å¤±è´¥:', error);
        item.retryCount = (item.retryCount || 0) + 1;
      }
    }

    // æ¸…ç†å·²åŒæ­¥é¡¹ç›®
    this.syncQueue = this.syncQueue.filter(item => !item.synced || item.retryCount < 3);
  }

  /**
   * åŒæ­¥åˆ°è®¾å¤‡
   */
  private async syncToDevice(item: SyncItem): Promise<void> {
    // å‘é€æ•°æ®åˆ°è®¾å¤‡
    const command = this.buildSyncCommand(item.data);
    await this.bluetooth.writeCharacteristic('sync', command);
  }

  /**
   * åŒæ­¥åˆ°äº‘ç«¯
   */
  private async syncToCloud(item: SyncItem): Promise<void> {
    const response = await fetch('/api/iot/device-data', {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Authorization': `Bearer ${this.getToken()}`
      },
      body: JSON.stringify({
        deviceId: item.deviceId,
        data: item.data,
        timestamp: item.timestamp
      })
    });

    if (!response.ok) {
      throw new Error('äº‘ç«¯åŒæ­¥å¤±è´¥');
    }
  }
}

interface SyncItem {
  deviceId: string;
  data: any;
  timestamp: number;
  synced: boolean;
  retryCount?: number;
}
```

#### 3.5 å…¼å®¹æ€§å¤„ç†

##### 3.5.1 æµè§ˆå™¨å…¼å®¹æ€§

```typescript
// æµè§ˆå™¨å…¼å®¹æ€§æ£€æµ‹
interface BluetoothCompatibility {
  // æ”¯æŒçš„æµè§ˆå™¨
  supported: {
    chrome: {
      version: '56+',
      status: 'å®Œå…¨æ”¯æŒ',
      features: ['scan', 'connect', 'notify', 'write']
    };
    edge: {
      version: '79+',
      status: 'å®Œå…¨æ”¯æŒ',
      features: ['scan', 'connect', 'notify', 'write']
    };
    opera: {
      version: '43+',
      status: 'å®Œå…¨æ”¯æŒ',
      features: ['scan', 'connect', 'notify', 'write']
    };
    firefox: {
      version: 'éƒ¨åˆ†æ”¯æŒ',
      status: 'éœ€è¦å¼€å¯æ ‡å¿—',
      flags: 'dom.webbluetooth.enabled'
    };
    safari: {
      version: 'ä¸æ”¯æŒ',
      status: 'ä¸æ”¯æŒ',
      alternative: 'ä½¿ç”¨åŸç”ŸApp'
    };
  };

  // åŠŸèƒ½é™çº§
  fallback: {
    unsupported: {
      action: 'æç¤ºç”¨æˆ·ä½¿ç”¨æ”¯æŒçš„æµè§ˆå™¨',
      message: 'æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒWeb Bluetoothï¼Œè¯·ä½¿ç”¨Chrome/Edge/Operaæµè§ˆå™¨'
    };
    noBluetooth: {
      action: 'æä¾›æ‰‹åŠ¨æ§åˆ¶æ¨¡å¼',
      features: ['æ‰‹åŠ¨é€‰æ‹©è®¾ç½®', 'ä¿å­˜é…ç½®åˆ°è®¾å¤‡']
    };
  };
}

// å…¼å®¹æ€§æ£€æµ‹å‡½æ•°
export function checkBluetoothSupport(): BluetoothSupportResult {
  const isSupported = 'bluetooth' in navigator;

  if (!isSupported) {
    return {
      supported: false,
      message: getUnsupportedMessage(),
      alternative: getAlternativeMethod()
    };
  }

  // æ£€æŸ¥å…·ä½“åŠŸèƒ½æ”¯æŒ
  const canScan = 'requestDevice' in (navigator as any).bluetooth;
  const canConnect = 'getAvailability' in navigator.bluetooth;

  return {
    supported: true,
    canScan,
    canConnect,
    recommendedBrowser: getRecommendedBrowser()
  };
}

function getUnsupportedMessage(): string {
  const ua = navigator.userAgent;
  if (ua.includes('Safari') && !ua.includes('Chrome')) {
    return 'Safariæš‚ä¸æ”¯æŒWeb Bluetoothï¼Œè¯·ä½¿ç”¨Chromeæˆ–Edgeæµè§ˆå™¨';
  }
  if (ua.includes('Firefox')) {
    return 'Firefoxéœ€è¦å¼€å¯å®éªŒæ€§åŠŸèƒ½ï¼Œå»ºè®®ä½¿ç”¨Chromeæˆ–Edgeæµè§ˆå™¨';
  }
  return 'æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒWeb Bluetoothï¼Œè¯·ä½¿ç”¨Chromeæˆ–Edgeæµè§ˆå™¨';
}
```

---

## é™„å½•

### A. BLEæœåŠ¡UUIDåˆ—è¡¨

### B. è®¾å¤‡é€šä¿¡åè®®

### C. é”™è¯¯å¤„ç†æœºåˆ¶

### D. æœ¯è¯­è¡¨

| æœ¯è¯­ | è¯´æ˜ |
|-----|------|
| **BLE** | Bluetooth Low Energyï¼Œä½åŠŸè€—è“ç‰™ |
| **GATT** | Generic Attribute Profileï¼Œé€šç”¨å±æ€§é…ç½®æ–‡ä»¶ |
| **UUID** | Universally Unique Identifierï¼Œé€šç”¨å”¯ä¸€æ ‡è¯†ç¬¦ |

### E. ä¿®è®¢å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¿®è®¢äºº | ä¿®è®¢å†…å®¹ |
|-----|------|-------|---------|
| v1.0.0 | 2026-01-26 | YanYuCloudCube Team | åˆå§‹ç‰ˆæœ¬åˆ›å»º |

---

> ã€Œ***YanYuCloudCube***ã€
> ã€Œ***<admin@0379.email>***ã€
> ã€Œ***Words Initiate Quadrants, Language Serves as Core for the Future***ã€
> ã€Œ***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***ã€

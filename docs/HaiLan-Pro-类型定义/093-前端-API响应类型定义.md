---
@file: 093-前端-API响应类型定义.md
@description: HaiLan Pro 前端API响应数据类型定义，统一接口响应格式
@author: YanYuCloudCube Team
@version: v1.0.0
@created: 2026-01-26
@updated: 2026-01-26
@status: published
@tags: [HaiLan-Pro-类型定义],[]
---

> ***YanYuCloudCube***
> **标语**：言启象限 | 语枢未来
> ***Words Initiate Quadrants, Language Serves as Core for the Future***
> **标语**：万象归元于云枢 | 深栈智启新纪元
> ***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***

---

# 093 前端-API响应类型定义

## 概述

本文档详细描述HaiLan Pro-HaiLan-Pro-类型定义-前端-API响应类型定义相关内容，确保项目按照YYC³标准规范进行开发和实施。

## 核心内容

### 1. 背景与目标

#### 1.1 项目背景
HaiLan Pro (海蓝) 是新一代高端、私密、智能的情趣健康生活管理平台。项目基于「五高五标五化」理念，通过 PWA 技术结合 AI 智能辅助与物联网，为用户提供从生理健康到心理愉悦的全方位解决方案。

#### 1.2 项目愿景
打造极致隐私、智能陪伴、品质合规、全场景覆盖的情趣健康生活管理平台，为用户提供安全、专业、高端的健康生活体验。

#### 1.3 核心价值主张
- **极致隐私**：双重加密、隐私浏览模式及伪装发货机制
- **智能陪伴**：基于 LLM 的 AI 情感与生理健康顾问
- **品质合规**：医疗级标准商品，高端"海蓝蓝"视觉调性
- **全场景覆盖**：PWA 端支持离线浏览、桌面安装及无缝推送

#### 1.4 文档目标
- 规范前端-API响应类型定义相关的业务标准与技术落地要求
- 为项目相关人员提供清晰的参考依据
- 保障相关模块开发、实施、运维的一致性与规范性

### 2. 设计原则

#### 2.1 五高原则
- **高可用性**：确保系统7x24小时稳定运行，支持PWA离线能力
- **高性能**：优化响应时间和处理能力，支持高并发访问
- **高安全性**：保护用户数据和隐私安全，双重加密机制
- **高扩展性**：支持业务快速扩展，微服务架构设计
- **高可维护性**：便于后续维护和升级，模块化设计

#### 2.2 五标体系
- **标准化**：统一的技术和流程标准
- **规范化**：严格的开发和管理规范
- **自动化**：提高开发效率和质量，CI/CD自动化
- **智能化**：利用AI技术提升能力，LLM智能顾问
- **可视化**：直观的监控和管理界面

#### 2.3 五化架构
- **流程化**：标准化的开发流程
- **文档化**：完善的文档体系
- **工具化**：高效的开发工具链
- **数字化**：数据驱动的决策
- **生态化**：开放的生态系统

### 3. 前端API响应类型定义

#### 3.1 统一响应格式

```typescript
/**
 * src/types/api/response.ts
 * 统一API响应格式定义
 */

/**
 * 标准API响应结构
 */
export interface ApiResponse<T = any> {
  /** 响应码：0成功，非0失败 */
  code: number;
  /** 响应消息 */
  message: string;
  /** 响应数据 */
  data?: T;
  /** 时间戳 */
  timestamp: number;
  /** 请求ID（用于问题追踪） */
  requestId: string;
}

/**
 * 分页响应结构
 */
export interface PaginatedResponse<T> {
  /** 数据列表 */
  items: T[];
  /** 总数 */
  total: number;
  /** 当前页 */
  page: number;
  /** 每页数量 */
  pageSize: number;
  /** 总页数 */
  totalPages: number;
}

/**
 * 流式响应数据块
 */
export interface StreamChunk {
  /** 事件类型：start/token/end/error */
  event: 'start' | 'token' | 'end' | 'error';
  /** 内容片段 */
  content?: string;
  /** 是否结束 */
  done?: boolean;
  /** 错误信息 */
  error?: string;
}
```

#### 3.2 用户模块API响应类型

```typescript
/**
 * src/types/api/user.response.ts
 */

/**
 * 用户注册响应
 */
export interface RegisterResponse {
  /** 访问令牌 */
  accessToken: string;
  /** 刷新令牌 */
  refreshToken: string;
  /** 令牌类型 */
  tokenType: 'Bearer';
  /** 过期时间（秒） */
  expiresIn: number;
  /** 用户信息 */
  user: UserInfo;
}

/**
 * 用户登录响应
 */
export type LoginResponse = RegisterResponse;

/**
 * 用户信息响应
 */
export interface UserInfoResponse {
  /** 用户基本信息 */
  user: UserInfo;
  /** 用户权限列表 */
  permissions: string[];
  /** 用户角色列表 */
  roles: string[];
  /** 用户配置 */
  settings: UserSettings;
}

/**
 * 用户设置响应
 */
export interface UserSettingsResponse {
  /** 通知设置 */
  notification: NotificationSettings;
  /** 隐私设置 */
  privacy: UserPrivacySettings;
  /** 显示设置 */
  display: DisplaySettings;
}

/**
 * 刷新令牌响应
 */
export interface RefreshTokenResponse {
  /** 新的访问令牌 */
  accessToken: string;
  /** 新的刷新令牌 */
  refreshToken: string;
  /** 过期时间（秒） */
  expiresIn: number;
}
```

#### 3.3 商品模块API响应类型

```typescript
/**
 * src/types/api/product.response.ts
 */

/**
 * 商品列表响应
 */
export interface ProductListResponse {
  /** 商品列表 */
  items: Product[];
  /** 总数 */
  total: number;
  /** 分页信息 */
  pagination: {
    page: number;
    pageSize: number;
    totalPages: number;
  };
  /** 筛选汇总 */
  aggregations?: {
    categories?: Record<string, number>;
    brands?: Record<string, number>;
    priceRanges?: Record<string, number>;
  };
}

/**
 * 商品详情响应
 */
export interface ProductDetailResponse {
  /** 商品信息 */
  product: Product;
  /** SKU列表 */
  skus: ProductSku[];
  /** 相关推荐 */
  recommendations?: Product[];
  /** 商品规格 */
  specifications?: ProductSpecification;
  /** 评价统计 */
  reviewSummary: ReviewSummary;
  /** 促销信息 */
  promotion?: PromotionInfo;
}

/**
 * 商品规格
 */
export interface ProductSpecification {
  /** 规格组列表 */
  specGroups: SpecGroup[];
  /** 规格属性映射 */
  specAttributes: Record<string, SpecValue[]>;
}

/**
 * 规格组
 */
export interface SpecGroup {
  /** 组名 */
  name: string;
  /** 规格值列表 */
  values: SpecValue[];
}

/**
 * 规格值
 */
export interface SpecValue {
  /** 规格值ID */
  id: string;
  /** 规格值名称 */
  name: string;
  /** 规格值图片 */
  image?: string;
  /** 是否可选 */
  available: boolean;
}

/**
 * 评价汇总
 */
export interface ReviewSummary {
  /** 平均评分 */
  average: number;
  /** 总评分数 */
  total: number;
  /** 评分分布 */
  distribution: {
    5: number;
    4: number;
    3: number;
    2: number;
    1: number;
  };
}
```

#### 3.4 订单模块API响应类型

```typescript
/**
 * src/types/api/order.response.ts
 */

/**
 * 创建订单响应
 */
export interface CreateOrderResponse {
  /** 订单ID */
  orderId: string;
  /** 订单号 */
  orderNo: string;
  /** 应付金额 */
  payableAmount: number;
  /** 支付信息 */
  payment?: PaymentInfo;
}

/**
 * 订单列表响应
 */
export interface OrderListResponse {
  /** 订单列表 */
  items: Order[];
  /** 总数 */
  total: number;
  /** 分页信息 */
  pagination: PaginationInfo;
  /** 订单统计 */
  statistics: OrderStatistics;
}

/**
 * 订单详情响应
 */
export interface OrderDetailResponse {
  /** 订单信息 */
  order: Order;
  /** 订单商品列表 */
  items: OrderItem[];
  /** 物流信息 */
  logistics?: LogisticsInfo;
  /** 支付信息 */
  payment: PaymentInfo;
  /* 退款信息 */
  refund?: RefundInfo;
}

/**
 * 物流信息
 */
export interface LogisticsInfo {
  /** 物流公司 */
  company: string;
  /** 物流单号 */
  trackingNumber: string;
  /** 物流状态 */
  status: ShippingStatus;
  /** 物流转运记录 */
  traces: LogisticsTrace[];
  /** 预计送达时间 */
  estimatedDelivery?: string;
}

/**
 * 物流转运记录
 */
export interface LogisticsTrace {
  /** 时间 */
  time: string;
  /** 状态描述 */
  status: string;
  /** 位置信息 */
  location?: string;
}

/**
 * 支付信息
 */
export interface PaymentInfo {
  /** 支付方式 */
  method: PaymentMethod;
  /** 支付状态 */
  status: PaymentTransactionStatus;
  /** 交易号 */
  transactionId?: string;
  /** 支付时间 */
  paidAt?: string;
  /** 支付金额 */
  amount: number;
}

/**
 * 退款信息
 */
export interface RefundInfo {
  /** 退款ID */
  refundId: string;
  /** 退款金额 */
  refundAmount: number;
  /** 退款状态 */
  status: RefundStatus;
  /** 退款原因 */
  reason?: string;
  /** 申请时间 */
  createdAt: string;
  /** 处理时间 */
  processedAt?: string;
}
```

#### 3.5 AI模块API响应类型

```typescript
/**
 * src/types/api/ai.response.ts
 */

/**
 * AI对话列表响应
 */
export interface ConversationListResponse {
  /** 会话列表 */
  items: AIConversation[];
  /** 总数 */
  total: number;
}

/**
 * AI对话详情响应
 */
export interface ConversationDetailResponse {
  /** 会话信息 */
  conversation: AIConversation;
  /** 消息列表 */
  messages: AIMessage[];
  /** 会话配置 */
  config: ConversationConfig;
}

/**
 * 发送消息响应
 */
export interface SendMessageResponse {
  /** 消息ID */
  messageId: string;
  /** AI回复内容 */
  content: string;
  /** 是否完成 */
  completed: boolean;
  /** Token使用情况 */
  usage?: {
    promptTokens: number;
    completionTokens: number;
    totalTokens: number;
  };
}

/**
 * 会话配置
 */
export interface ConversationConfig {
  /** AI人格 */
  aiPersonality: AIPersonality;
  /** 温度参数 */
  temperature: number;
  /** 最大Token数 */
  maxTokens: number;
  /** 系统提示词 */
  systemPrompt?: string;
}

/**
 * 流式消息响应
 */
export interface StreamMessageResponse {
  /** 事件类型 */
  event: string;
  /** 数据 */
  data: StreamChunk;
}
```

#### 3.6 IoT模块API响应类型

```typescript
/**
 * src/types/api/iot.response.ts
 */

/**
 * 设备列表响应
 */
export interface DeviceListResponse {
  /** 设备列表 */
  items: IoTDevice[];
  /** 总数 */
  total: number;
}

/**
 * 设备详情响应
 */
export interface DeviceDetailResponse {
  /** 设备信息 */
  device: IoTDevice;
  /** 设备配置 */
  config: DeviceConfig;
  /** 设备数据 */
  data: DeviceData;
  /** 连接历史 */
  connectionHistory: ConnectionHistory[];
}

/**
 * 设备配置
 */
export interface DeviceConfig {
  /** 控制参数 */
  controlParams: ControlParam[];
  /** 支持的模式 */
  modes: DeviceMode[];
  /** 最大连接数 */
  maxConnections: number;
  /** 电池信息 */
  battery: BatteryInfo;
}

/**
 * 控制参数
 */
export interface ControlParam {
  /** 参数名 */
  name: string;
  /** 参数类型 */
  type: 'range' | 'select' | 'boolean';
  /** 最小值 */
  min?: number;
  /** 最大值 */
  max?: number;
  /** 步长 */
  step?: number;
  /** 选项列表 */
  options?: Array<{ value: number; label: string }>;
  /** 单位 */
  unit?: string;
}

/**
 * 设备数据
 */
export interface DeviceData {
  /** 会话数据 */
  sessions: DeviceSessionData[];
  /** 设置数据 */
  settings: DeviceSettingsData;
  /** 健康数据 */
  health: DeviceHealthData;
}

/**
 * 设备会话数据
 */
export interface DeviceSessionData {
  /** 会话ID */
  sessionId: string;
  /** 开始时间 */
  startTime: string;
  /** 结束时间 */
  endTime?: string;
  /** 模式设置 */
  modes: number[];
  /** 持续时长（分钟） */
  duration: number;
}

/**
 * 连接历史
 */
export interface ConnectionHistory {
  /** 连接时间 */
  connectedAt: string;
  /** 断开时间 */
  disconnectedAt?: string;
  /** 连接时长（秒） */
  duration?: number;
  /** 连接状态 */
  status: 'success' | 'failed' | 'timeout';
}
```

#### 3.7 通知模块API响应类型

```typescript
/**
 * src/types/api/notification.response.ts
 */

/**
 * 通知列表响应
 */
export interface NotificationListResponse {
  /** 通知列表 */
  items: Notification[];
  /** 未读数量 */
  unreadCount: number;
  /** 分页信息 */
  pagination: PaginationInfo;
}

/**
 * 通知详情响应
 */
export interface NotificationDetailResponse {
  /** 通知信息 */
  notification: Notification;
  /** 相关数据 */
  relatedData?: RelatedData;
}

/**
 * 通知信息
 */
export interface Notification {
  /** 通知ID */
  id: string;
  /** 用户ID */
  userId: string;
  /** 通知类型 */
  type: NotificationType;
  /** 标题 */
  title: string;
  /** 内容 */
  content: string;
  /** 数据 */
  data?: Record<string, any>;
  /** 操作链接 */
  actionUrl?: string;
  /** 操作文字 */
  actionText?: string;
  /** 状态 */
  status: NotificationStatus;
  /** 创建时间 */
  createdAt: string;
  /** 阅读时间 */
  readAt?: string;
}

/**
 * 相关数据
 */
export interface RelatedData {
  /** 订单信息（当type为order时） */
  order?: Order;
  /** 商品信息（当type为promotion时） */
  product?: Product;
}

/**
 * 未读统计响应
 */
export interface UnreadCountResponse {
  /** 总未读数 */
  total: number;
  /** 分类未读数 */
  byType: Record<NotificationType, number>;
}
```

#### 3.8 错误响应类型

```typescript
/**
 * src/types/api/error.response.ts
 */

/**
 * API错误响应
 */
export interface ApiErrorResponse {
  /** 响应码：非0表示错误 */
  code: number;
  /** 错误消息 */
  message: string;
  /** 错误详情 */
  details?: ErrorDetails;
  /** 请求ID */
  requestId: string;
  /** 时间戳 */
  timestamp: number;
}

/**
 * 错误详情
 */
export interface ErrorDetails {
  /** 字段错误详情 */
  fields?: Record<string, string[]>;
  /** 业务错误详情 */
  business?: Record<string, any>;
  /** 技术错误详情 */
  technical?: {
    /** 异常类名 */
    exception: string;
    /** 错误消息 */
    message: string;
    /** 堆栈信息（开发环境） */
    stack?: string;
  };
}

/**
 * 常见错误码
 */
export enum ErrorCode {
  // ========== 通用错误 ==========
  /** 成功 */
  SUCCESS = 0,
  /** 参数校验失败 */
  VALIDATION_ERROR = 1001,
  /** 数据已存在 */
  DATA_EXISTS = 1002,
  /** 数据不存在 */
  DATA_NOT_FOUND = 1003,

  // ========== 认证授权 ==========
  /** 未登录 */
  UNAUTHORIZED = 2001,
  /** Token过期 */
  TOKEN_EXPIRED = 2002,
  /** Token无效 */
  TOKEN_INVALID = 2003,
  /** 权限不足 */
  FORBIDDEN = 2004,
  /** 验证码错误 */
  CAPTCHA_ERROR = 2005,

  // ========== 用户相关 ==========
  /** 用户不存在 */
  USER_NOT_FOUND = 3001,
  /** 用户已禁用 */
  USER_BANNED = 3002,
  /** 账户或密码错误 */
  INVALID_CREDENTIALS = 3003,
  /** 年龄验证失败 */
  AGE_VERIFICATION_FAILED = 3004,

  // ========== 商品相关 ==========
  /** 商品不存在 */
  PRODUCT_NOT_FOUND = 4001,
  /** 商品库存不足 */
  INSUFFICIENT_STOCK = 4002,
  /** 商品已下架 */
  PRODUCT_OFFLINE = 4003,

  // ========== 订单相关 ==========
  /** 订单不存在 */
  ORDER_NOT_FOUND = 5001,
  /** 订单状态错误 */
  INVALID_ORDER_STATUS = 5002,
  /** 订单已支付 */
  ORDER_ALREADY_PAID = 5003,
  /** 金额不匹配 */
  AMOUNT_MISMATCH = 5004,

  // ========== 支付相关 ==========
  /** 支付失败 */
  PAYMENT_FAILED = 6001,
  /** 支付超时 */
  PAYMENT_TIMEOUT = 6002,
  /** 退款失败 */
  REFUND_FAILED = 6003,

  // ========== 系统错误 ==========
  /** 服务器内部错误 */
  INTERNAL_ERROR = 9001,
  /** 服务不可用 */
  SERVICE_UNAVAILABLE = 9002,
  /** 数据库错误 */
  DATABASE_ERROR = 9003,
  /** 缓存服务错误 */
  CACHE_ERROR = 9004,
  /** 第三方服务错误 */
  EXTERNAL_SERVICE_ERROR = 9005
}
```

#### 3.9 分页类型定义

```typescript
/**
 * src/types/api/pagination.ts
 */

/**
 * 分页信息
 */
export interface PaginationInfo {
  /** 当前页 */
  page: number;
  /** 每页数量 */
  pageSize: number;
  /** 总页数 */
  totalPages: number;
  /** 是否有上一页 */
  hasPrev: boolean;
  /** 是否有下一页 */
  hasNext: boolean;
}

/**
 * 分页请求参数
 */
export interface PaginationRequest {
  /** 页码（从1开始） */
  page?: number;
  /** 每页数量 */
  pageSize?: number;
  /** 排序字段 */
  sortBy?: string;
  /** 排序方式 */
  sortOrder?: 'asc' | 'desc';
}

/**
 * 分页响应构建器
 */
export class PaginationBuilder {
  /**
   * 构建分页响应
   */
  static buildResponse<T>(
    items: T[],
    page: number,
    pageSize: number,
    total: number
  ): PaginatedResponse<T> {
    return {
      items,
      total,
      page,
      pageSize,
      totalPages: Math.ceil(total / pageSize)
    };
  }

  /**
   * 构建分页信息
   */
  static buildInfo(
    page: number,
    pageSize: number,
    total: number
  ): PaginationInfo {
    const totalPages = Math.ceil(total / pageSize);
    return {
      page,
      pageSize,
      totalPages,
      hasPrev: page > 1,
      hasNext: page < totalPages
    };
  }
}
```

#### 3.10 流式响应处理类型

```typescript
/**
 * src/types/api/stream.ts
 * 流式响应处理类型定义
 */

/**
 * 流式响应处理器
 */
export class StreamResponseProcessor {
  /**
   * 处理流式响应
   */
  static async *processStream(
    response: Response
  ): AsyncGenerator<string, void, unknown> {
    const reader = response.body?.getReader();
    if (!reader) {
      throw new Error('Response body is not readable');
    }

    const decoder = new TextDecoder();
    let buffer = '';

    while (true) {
      const { done, value } = await reader.read();
      if (done) break;

      buffer += decoder.decode(value, { stream: true });

      const lines = buffer.split('\n');
      buffer = lines.pop() || '';

      for (const line of lines) {
        if (line.trim()) {
          const chunk = JSON.parse(line) as StreamChunk;
          if (chunk.event === 'token' && chunk.content) {
            yield chunk.content;
          }
        }
      }
    }

    // 处理剩余内容
    if (buffer.trim()) {
      const chunk = JSON.parse(buffer) as StreamChunk;
      if (chunk.event === 'token' && chunk.content) {
        yield chunk.content;
      }
    }
  }

  /**
   * 创建流式请求配置
   */
  static createStreamConfig(): RequestInit {
    return {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'Accept': 'text/event-stream'
      }
    };
  }
}
```

---

> 「***YanYuCloudCube***」
> 「***<admin@0379.email>***」
> 「***Words Initiate Quadrants, Language Serves as Core for the Future***」
> 「***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***」

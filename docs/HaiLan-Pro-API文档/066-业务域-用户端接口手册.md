---
@file: 066-业务域-用户端接口手册.md
@description: HaiLan Pro 用户端所有业务接口的详细定义，包含入参、出参、调用示例
@author: YanYuCloudCube Team
@version: v1.0.0
@created: 2026-02-03
@updated: 2026-02-03
@status: published
@tags: [API接口],[业务域],[用户端]
---

> ***YanYuCloudCube***
> **标语**：言启象限 | 语枢未来
> ***Words Initiate Quadrants, Language Serves as Core for the Future***
> **标语**：万象归元于云枢 | 深栈智启新纪元
> ***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***

---

# 066 业务域-用户端接口手册

## 概述

本文档详细描述HaiLan Pro项目用户端所有业务接口的详细定义，包含入参、出参、调用示例，确保项目按照YYC³标准规范进行开发和实施。

## 核心内容

### 1. 背景与目标

#### 1.1 项目背景
HaiLan Pro (海蓝) 是新一代高端、私密、智能的情趣健康生活管理平台。项目基于「五高五标五化」理念，通过 PWA 技术结合 AI 智能辅助与物联网，为用户提供从生理健康到心理愉悦的全方位解决方案。

#### 1.2 项目愿景
打造极致隐私、智能陪伴、品质合规、全场景覆盖的情趣健康生活管理平台，为用户提供安全、专业、高端的健康生活体验。

#### 1.3 核心价值主张
- **极致隐私**：双重加密、隐私浏览模式及伪装发货机制
- **智能陪伴**：基于 LLM 的 AI 情感与生理健康顾问
- **品质合规**：医疗级标准商品，高端"海蓝蓝"视觉调性
- **全场景覆盖**：PWA 端支持离线浏览、桌面安装及无缝推送

#### 1.4 文档目标
- 规范用户端接口的定义和使用
- 为前后端开发人员提供清晰的接口文档
- 保障接口的一致性和可维护性

### 2. 接口列表

| 接口名称 | HTTP方法 | 路径 | 认证要求 |
|---------|---------|------|---------|
| 用户注册 | POST | /api/v1.0/users/register | 公开 |
| 用户登录 | POST | /api/v1.0/users/login | 公开 |
| 刷新Token | POST | /api/v1.0/users/refresh-token | 公开 |
| 获取用户信息 | GET | /api/v1.0/users/{userId} | JWT Token |
| 更新用户信息 | PUT | /api/v1.0/users/{userId} | JWT Token |
| 修改密码 | POST | /api/v1.0/users/{userId}/password | JWT Token |
| 发送验证码 | POST | /api/v1.0/users/verify-code | 公开 |
| 验证邮箱 | POST | /api/v1.0/users/verify-email | 公开 |
| 重置密码 | POST | /api/v1.0/users/reset-password | 公开 |
| 退出登录 | POST | /api/v1.0/users/logout | JWT Token |
| 删除账户 | DELETE | /api/v1.0/users/{userId} | JWT Token |

### 3. 接口详情

#### 3.1 用户注册

##### 3.1.1 接口定义
```
POST /api/v1.0/users/register
```

##### 3.1.2 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| email | string | 是 | 邮箱地址 | user@example.com |
| password | string | 是 | 密码（8-20位，包含字母和数字） | password123 |
| username | string | 是 | 用户名（4-20位） | johndoe |
| phone | string | 否 | 手机号 | 13800138000 |
| agreeTerms | boolean | 是 | 是否同意服务条款 | true |

##### 3.1.3 请求示例
```json
{
  "email": "user@example.com",
  "password": "password123",
  "username": "johndoe",
  "phone": "13800138000",
  "agreeTerms": true
}
```

##### 3.1.4 响应参数

| 参数名 | 类型 | 说明 |
|-------|------|------|
| userId | string | 用户ID |
| email | string | 邮箱地址 |
| username | string | 用户名 |
| token | string | JWT Token |
| refreshToken | string | 刷新Token |
| expiresIn | number | Token过期时间（秒） |

##### 3.1.5 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "注册成功",
  "data": {
    "userId": "user-123",
    "email": "user@example.com",
    "username": "johndoe",
    "token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "refresh-token-xxx",
    "expiresIn": 86400
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.1.6 错误响应
```json
{
  "success": false,
  "code": 1130,
  "message": "用户已存在",
  "error": {
    "type": "BUSINESS_ERROR",
    "field": "email",
    "details": "该邮箱已被注册"
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.1.7 错误码
| 错误码 | 说明 |
|-------|------|
| 1100 | 用户名格式错误 |
| 1101 | 邮箱格式错误 |
| 1102 | 手机号格式错误 |
| 1103 | 密码格式错误 |
| 1130 | 用户已存在 |
| 1003 | 必填参数为空 |

#### 3.2 用户登录

##### 3.2.1 接口定义
```
POST /api/v1.0/users/login
```

##### 3.2.2 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| email | string | 是 | 邮箱地址 | user@example.com |
| password | string | 是 | 密码 | password123 |
| rememberMe | boolean | 否 | 记住我 | false |

##### 3.2.3 请求示例
```json
{
  "email": "user@example.com",
  "password": "password123",
  "rememberMe": false
}
```

##### 3.2.4 响应参数

| 参数名 | 类型 | 说明 |
|-------|------|------|
| userId | string | 用户ID |
| email | string | 邮箱地址 |
| username | string | 用户名 |
| avatar | string | 头像URL |
| token | string | JWT Token |
| refreshToken | string | 刷新Token |
| expiresIn | number | Token过期时间（秒） |

##### 3.2.5 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "登录成功",
  "data": {
    "userId": "user-123",
    "email": "user@example.com",
    "username": "johndoe",
    "avatar": "https://cdn.hailan.com/avatars/user-123.jpg",
    "token": "eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...",
    "refreshToken": "refresh-token-xxx",
    "expiresIn": 86400
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.2.6 错误码
| 错误码 | 说明 |
|-------|------|
| 1120 | 用户名或密码错误 |
| 1131 | 用户不存在 |
| 1132 | 用户已被禁用 |

#### 3.3 刷新Token

##### 3.3.1 接口定义
```
POST /api/v1.0/users/refresh-token
```

##### 3.3.2 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| refreshToken | string | 是 | 刷新Token | refresh-token-xxx |

##### 3.3.3 请求示例
```json
{
  "refreshToken": "refresh-token-xxx"
}
```

##### 3.3.4 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "Token刷新成功",
  "data": {
    "token": "new-jwt-token-xxx",
    "refreshToken": "new-refresh-token-xxx",
    "expiresIn": 86400
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.3.5 错误码
| 错误码 | 说明 |
|-------|------|
| 1121 | Token已过期 |
| 1122 | Token无效 |

#### 3.4 获取用户信息

##### 3.4.1 接口定义
```
GET /api/v1.0/users/{userId}
```

##### 3.4.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.4.3 路径参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| userId | string | 是 | 用户ID | user-123 |

##### 3.4.4 响应参数

| 参数名 | 类型 | 说明 |
|-------|------|------|
| userId | string | 用户ID |
| email | string | 邮箱地址 |
| username | string | 用户名 |
| avatar | string | 头像URL |
| phone | string | 手机号（脱敏） |
| privacyMode | string | 隐私模式 |
| createdAt | string | 创建时间 |
| updatedAt | string | 更新时间 |

##### 3.4.5 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "获取成功",
  "data": {
    "userId": "user-123",
    "email": "user@example.com",
    "username": "johndoe",
    "avatar": "https://cdn.hailan.com/avatars/user-123.jpg",
    "phone": "138****8000",
    "privacyMode": "STANDARD",
    "createdAt": "2026-01-01T00:00:00.000Z",
    "updatedAt": "2026-02-03T10:00:00.000Z"
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.4.6 错误码
| 错误码 | 说明 |
|-------|------|
| 1131 | 用户不存在 |
| 1121 | Token已过期 |
| 1122 | Token无效 |

#### 3.5 更新用户信息

##### 3.5.1 接口定义
```
PUT /api/v1.0/users/{userId}
```

##### 3.5.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.5.3 路径参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| userId | string | 是 | 用户ID | user-123 |

##### 3.5.4 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| username | string | 否 | 用户名 | johndoe |
| avatar | string | 否 | 头像URL | https://example.com/avatar.jpg |
| phone | string | 否 | 手机号 | 13800138000 |

##### 3.5.5 请求示例
```json
{
  "username": "johndoe",
  "avatar": "https://example.com/avatar.jpg",
  "phone": "13800138000"
}
```

##### 3.5.6 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "更新成功",
  "data": {
    "userId": "user-123",
    "email": "user@example.com",
    "username": "johndoe",
    "avatar": "https://example.com/avatar.jpg",
    "phone": "138****8000",
    "updatedAt": "2026-02-03T10:00:00.000Z"
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.5.7 错误码
| 错误码 | 说明 |
|-------|------|
| 1131 | 用户不存在 |
| 1100 | 用户名格式错误 |
| 1102 | 手机号格式错误 |

#### 3.6 修改密码

##### 3.6.1 接口定义
```
POST /api/v1.0/users/{userId}/password
```

##### 3.6.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.6.3 路径参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| userId | string | 是 | 用户ID | user-123 |

##### 3.6.4 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| oldPassword | string | 是 | 旧密码 | oldpassword123 |
| newPassword | string | 是 | 新密码 | newpassword456 |

##### 3.6.5 请求示例
```json
{
  "oldPassword": "oldpassword123",
  "newPassword": "newpassword456"
}
```

##### 3.6.6 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "密码修改成功",
  "data": null,
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.6.7 错误码
| 错误码 | 说明 |
|-------|------|
| 1131 | 用户不存在 |
| 1120 | 旧密码错误 |
| 1103 | 新密码格式错误 |

#### 3.7 发送验证码

##### 3.7.1 接口定义
```
POST /api/v1.0/users/verify-code
```

##### 3.7.2 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| email | string | 是 | 邮箱地址 | user@example.com |
| type | string | 是 | 验证码类型 | REGISTER/RESET_PASSWORD |

##### 3.7.3 请求示例
```json
{
  "email": "user@example.com",
  "type": "REGISTER"
}
```

##### 3.7.4 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "验证码已发送",
  "data": {
    "expiresIn": 300
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.7.5 错误码
| 错误码 | 说明 |
|-------|------|
| 1101 | 邮箱格式错误 |
| 1131 | 用户不存在 |
| 429 | 请求过于频繁 |

#### 3.8 重置密码

##### 3.8.1 接口定义
```
POST /api/v1.0/users/reset-password
```

##### 3.8.2 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| email | string | 是 | 邮箱地址 | user@example.com |
| verifyCode | string | 是 | 验证码 | 123456 |
| newPassword | string | 是 | 新密码 | newpassword456 |

##### 3.8.3 请求示例
```json
{
  "email": "user@example.com",
  "verifyCode": "123456",
  "newPassword": "newpassword456"
}
```

##### 3.8.4 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "密码重置成功",
  "data": null,
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.8.5 错误码
| 错误码 | 说明 |
|-------|------|
| 1101 | 邮箱格式错误 |
| 1140 | 验证码错误 |
| 1141 | 验证码已过期 |
| 1103 | 新密码格式错误 |

#### 3.9 退出登录

##### 3.9.1 接口定义
```
POST /api/v1.0/users/logout
```

##### 3.9.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.9.3 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "退出成功",
  "data": null,
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

#### 3.10 删除账户

##### 3.10.1 接口定义
```
DELETE /api/v1.0/users/{userId}
```

##### 3.10.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.10.3 路径参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| userId | string | 是 | 用户ID | user-123 |

##### 3.10.4 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "账户删除成功",
  "data": null,
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.10.5 错误码
| 错误码 | 说明 |
|-------|------|
| 1131 | 用户不存在 |
| 1121 | Token已过期 |

### 4. 数据模型

#### 4.1 用户信息模型

```typescript
interface User {
  userId: string;
  email: string;
  username: string;
  avatar?: string;
  phone?: string;
  privacyMode: 'STANDARD' | 'STEALTH' | 'DISGUISE';
  createdAt: string;
  updatedAt: string;
}
```

#### 4.2 登录响应模型

```typescript
interface LoginResponse {
  userId: string;
  email: string;
  username: string;
  avatar?: string;
  token: string;
  refreshToken: string;
  expiresIn: number;
}
```

### 5. 最佳实践

#### 5.1 前端实现

##### 5.1.1 统一请求拦截
```typescript
// 添加Token到所有请求
apiClient.interceptors.request.use((config) => {
  const token = localStorage.getItem('token');
  if (token) {
    config.headers.Authorization = `Bearer ${token}`;
  }
  return config;
});
```

##### 5.1.2 Token过期处理
```typescript
// 自动刷新Token
apiClient.interceptors.response.use(
  (response) => response,
  async (error) => {
    if (error.response?.status === 401) {
      const refreshToken = localStorage.getItem('refreshToken');
      if (refreshToken) {
        const response = await refreshAccessToken(refreshToken);
        localStorage.setItem('token', response.data.token);
        localStorage.setItem('refreshToken', response.data.refreshToken);
        return apiClient.request(error.config);
      }
    }
    return Promise.reject(error);
  }
);
```

#### 5.2 后端实现

##### 5.2.1 密码加密
```typescript
// 使用bcrypt加密密码
import * as bcrypt from 'bcrypt';

const hashedPassword = await bcrypt.hash(plainPassword, 10);
```

##### 5.2.2 验证码生成
```typescript
// 生成6位数字验证码
const verifyCode = Math.floor(100000 + Math.random() * 900000).toString();
```

### 6. 安全注意事项

#### 6.1 密码安全
- 密码必须加密存储
- 使用bcrypt或Argon2算法
- 密码强度验证
- 禁止明文传输

#### 6.2 验证码安全
- 验证码有效期5分钟
- 验证码使用后立即失效
- 限制发送频率（1分钟1次）
- 记录发送日志

#### 6.3 隐私保护
- 敏感信息脱敏显示
- 不在日志中记录密码
- 不在响应中返回完整手机号
- 支持隐私模式访问

## 附录

### A. 参考文档

- RESTful接口设计标准
- 接口错误码体系
- 接口签名鉴权手册
- YYC³项目规范文档

### B. 术语表

- JWT：JSON Web Token
- API：Application Programming Interface
- PWA：Progressive Web App
- DID：Decentralized Identity

---

<div align="center">

> 「***YanYuCloudCube***」
> 「***<admin@0379.email>***」
> 「***Words Initiate Quadrants, Language Serves as Core for the Future***」
> 「***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***」

</div>

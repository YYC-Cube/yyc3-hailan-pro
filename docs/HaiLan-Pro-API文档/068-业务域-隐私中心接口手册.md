---
@file: 068-业务域-隐私中心接口手册.md
@description: HaiLan Pro 隐私中心相关接口的详细定义，包含隐私模式、伪装、安全设置等
@author: YanYuCloudCube Team
@version: v1.0.0
@created: 2026-02-03
@updated: 2026-02-03
@status: published
@tags: [API接口],[业务域],[隐私中心]
---

> ***YanYuCloudCube***
> **标语**：言启象限 | 语枢未来
> ***Words Initiate Quadrants, Language Serves as Core for the Future***
> **标语**：万象归元于云枢 | 深栈智启新纪元
> ***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***

---

# 068 业务域-隐私中心接口手册

## 概述

本文档详细描述HaiLan Pro项目隐私中心相关接口的详细定义，包含隐私模式、伪装、安全设置等，确保项目按照YYC³标准规范进行开发和实施。

## 核心内容

### 1. 背景与目标

#### 1.1 项目背景
HaiLan Pro (海蓝) 是新一代高端、私密、智能的情趣健康生活管理平台。项目基于「五高五标五化」理念，通过 PWA 技术结合 AI 智能辅助与物联网，为用户提供从生理健康到心理愉悦的全方位解决方案。

#### 1.2 项目愿景
打造极致隐私、智能陪伴、品质合规、全场景覆盖的情趣健康生活管理平台，为用户提供安全、专业、高端的健康生活体验。

#### 1.3 核心价值主张
- **极致隐私**：双重加密、隐私浏览模式及伪装发货机制
- **智能陪伴**：基于 LLM 的 AI 情感与生理健康顾问
- **品质合规**：医疗级标准商品，高端"海蓝蓝"视觉调性
- **全场景覆盖**：PWA 端支持离线浏览、桌面安装及无缝推送

#### 1.4 文档目标
- 规范隐私中心接口的定义和使用
- 为前后端开发人员提供清晰的接口文档
- 保障接口的一致性和可维护性

### 2. 接口列表

| 接口名称 | HTTP方法 | 路径 | 认证要求 |
|---------|---------|------|---------|
| 获取隐私设置 | GET | /api/v1.0/privacy/settings | JWT Token |
| 更新隐私模式 | PUT | /api/v1.0/privacy/privacy-mode | JWT Token |
| 设置伪装发货 | PUT | /api/v1.0/privacy/disguise-shipping | JWT Token |
| 获取伪装发货列表 | GET | /api/v1.0/privacy/disguise-options | JWT Token |
| 设置隐私密码 | POST | /api/v1.0/privacy/privacy-password | JWT Token |
| 验证隐私密码 | POST | /api/v1.0/privacy/verify-password | JWT Token |
| 清除浏览记录 | DELETE | /api/v1.0/privacy/browse-history | JWT Token |
| 设置应用锁 | PUT | /api/v1.0/privacy/app-lock | JWT Token |
| 获取安全日志 | GET | /api/v1.0/privacy/security-logs | JWT Token |
| 导出隐私数据 | GET | /api/v1.0/privacy/export-data | JWT Token |
| 删除隐私数据 | DELETE | /api/v1.0/privacy/delete-data | JWT Token |
| 设置双因素认证 | PUT | /api/v1.0/privacy/two-factor | JWT Token |
| 获取登录设备列表 | GET | /api/v1.0/privacy/devices | JWT Token |
| 移除登录设备 | DELETE | /api/v1.0/privacy/devices/{deviceId} | JWT Token |

### 3. 接口详情

#### 3.1 获取隐私设置

##### 3.1.1 接口定义
```
GET /api/v1.0/privacy/settings
```

##### 3.1.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.1.3 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "获取成功",
  "data": {
    "privacyMode": "STANDARD",
    "privacyModeText": "标准模式",
    "disguiseShipping": true,
    "disguiseType": "ELECTRONICS",
    "disguiseTypeText": "电子产品",
    "hasPrivacyPassword": true,
    "appLockEnabled": true,
    "twoFactorEnabled": false,
    "autoClearHistory": true,
    "autoClearDays": 7
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.1.4 错误码
| 错误码 | 说明 |
|-------|------|
| 1121 | Token已过期 |

#### 3.2 更新隐私模式

##### 3.2.1 接口定义
```
PUT /api/v1.0/privacy/privacy-mode
```

##### 3.2.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.2.3 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| privacyMode | string | 是 | 隐私模式 | STANDARD/STEALTH/DISGUISE |

##### 3.2.4 请求示例
```json
{
  "privacyMode": "STEALTH"
}
```

##### 3.2.5 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "隐私模式更新成功",
  "data": {
    "privacyMode": "STEALTH",
    "privacyModeText": "隐身模式"
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.2.6 错误码
| 错误码 | 说明 |
|-------|------|
| 5100 | 隐私模式参数错误 |
| 1121 | Token已过期 |

#### 3.3 设置伪装发货

##### 3.3.1 接口定义
```
PUT /api/v1.0/privacy/disguise-shipping
```

##### 3.3.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.3.3 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| enabled | boolean | 是 | 是否启用伪装发货 | true |
| disguiseType | string | 否 | 伪装类型 | ELECTRONICS/COSMETICS/BOOKS/OTHERS |
| customDisguiseName | string | 否 | 自定义伪装名称 | 智能手表 |

##### 3.3.4 请求示例
```json
{
  "enabled": true,
  "disguiseType": "ELECTRONICS",
  "customDisguiseName": "智能手表"
}
```

##### 3.3.5 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "伪装发货设置成功",
  "data": {
    "enabled": true,
    "disguiseType": "ELECTRONICS",
    "disguiseTypeText": "电子产品",
    "customDisguiseName": "智能手表"
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.3.6 错误码
| 错误码 | 说明 |
|-------|------|
| 5101 | 伪装类型不支持 |
| 1121 | Token已过期 |

#### 3.4 获取伪装发货列表

##### 3.4.1 接口定义
```
GET /api/v1.0/privacy/disguise-options
```

##### 3.4.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.4.3 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "获取成功",
  "data": [
    {
      "type": "ELECTRONICS",
      "name": "电子产品",
      "description": "智能手表、蓝牙耳机等",
      "icon": "https://cdn.hailan.com/icons/electronics.png"
    },
    {
      "type": "COSMETICS",
      "name": "化妆品",
      "description": "护肤品、彩妆等",
      "icon": "https://cdn.hailan.com/icons/cosmetics.png"
    },
    {
      "type": "BOOKS",
      "name": "书籍",
      "description": "图书、杂志等",
      "icon": "https://cdn.hailan.com/icons/books.png"
    },
    {
      "type": "OTHERS",
      "name": "其他",
      "description": "其他日用品",
      "icon": "https://cdn.hailan.com/icons/others.png"
    }
  ],
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.4.4 错误码
| 错误码 | 说明 |
|-------|------|
| 1121 | Token已过期 |

#### 3.5 设置隐私密码

##### 3.5.1 接口定义
```
POST /api/v1.0/privacy/privacy-password
```

##### 3.5.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.5.3 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| password | string | 是 | 隐私密码（6位数字） | 123456 |
| confirmPassword | string | 是 | 确认密码 | 123456 |

##### 3.5.4 请求示例
```json
{
  "password": "123456",
  "confirmPassword": "123456"
}
```

##### 3.5.5 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "隐私密码设置成功",
  "data": null,
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.5.6 错误码
| 错误码 | 说明 |
|-------|------|
| 5102 | 密码格式错误 |
| 5103 | 两次密码不一致 |
| 1121 | Token已过期 |

#### 3.6 验证隐私密码

##### 3.6.1 接口定义
```
POST /api/v1.0/privacy/verify-password
```

##### 3.6.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.6.3 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| password | string | 是 | 隐私密码 | 123456 |

##### 3.6.4 请求示例
```json
{
  "password": "123456"
}
```

##### 3.6.5 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "验证成功",
  "data": {
    "verified": true
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.6.6 错误码
| 错误码 | 说明 |
|-------|------|
| 5104 | 隐私密码错误 |
| 5105 | 隐私密码未设置 |
| 1121 | Token已过期 |

#### 3.7 清除浏览记录

##### 3.7.1 接口定义
```
DELETE /api/v1.0/privacy/browse-history
```

##### 3.7.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.7.3 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| days | number | 否 | 清除最近N天的记录 | 7 |

##### 3.7.4 请求示例
```json
{
  "days": 7
}
```

##### 3.7.5 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "浏览记录清除成功",
  "data": {
    "clearedCount": 150
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.7.6 错误码
| 错误码 | 说明 |
|-------|------|
| 1121 | Token已过期 |

#### 3.8 设置应用锁

##### 3.8.1 接口定义
```
PUT /api/v1.0/privacy/app-lock
```

##### 3.8.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.8.3 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| enabled | boolean | 是 | 是否启用应用锁 | true |
| lockType | string | 否 | 锁定类型 | PATTERN/PIN/BIOMETRIC |
| autoLockTime | number | 否 | 自动锁定时间（分钟） | 5 |

##### 3.8.4 请求示例
```json
{
  "enabled": true,
  "lockType": "PIN",
  "autoLockTime": 5
}
```

##### 3.8.5 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "应用锁设置成功",
  "data": {
    "enabled": true,
    "lockType": "PIN",
    "autoLockTime": 5
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.8.6 错误码
| 错误码 | 说明 |
|-------|------|
| 5106 | 锁定类型不支持 |
| 1121 | Token已过期 |

#### 3.9 获取安全日志

##### 3.9.1 接口定义
```
GET /api/v1.0/privacy/security-logs
```

##### 3.9.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.9.3 查询参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| page | number | 否 | 页码 | 1 |
| pageSize | number | 否 | 每页数量 | 20 |
| logType | string | 否 | 日志类型 | LOGIN/LOGOUT/SETTINGS |

##### 3.9.4 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "获取成功",
  "data": {
    "total": 50,
    "page": 1,
    "pageSize": 20,
    "logs": [
      {
        "logId": "log-123",
        "logType": "LOGIN",
        "logTypeText": "登录",
        "device": "iPhone 15 Pro",
        "ip": "192.168.1.1",
        "location": "广东省深圳市",
        "status": "SUCCESS",
        "createdAt": "2026-02-03T10:00:00.000Z"
      }
    ]
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.9.5 错误码
| 错误码 | 说明 |
|-------|------|
| 1121 | Token已过期 |

#### 3.10 导出隐私数据

##### 3.10.1 接口定义
```
GET /api/v1.0/privacy/export-data
```

##### 3.10.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.10.3 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "导出请求已提交",
  "data": {
    "exportId": "export-123",
    "status": "PROCESSING",
    "estimatedTime": 300
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.10.4 错误码
| 错误码 | 说明 |
|-------|------|
| 5107 | 导出请求过于频繁 |
| 1121 | Token已过期 |

#### 3.11 删除隐私数据

##### 3.11.1 接口定义
```
DELETE /api/v1.0/privacy/delete-data
```

##### 3.11.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.11.3 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| dataType | string | 是 | 数据类型 | BROWSE_HISTORY/ORDERS/ADDRESSES/ALL |
| password | string | 是 | 隐私密码 | 123456 |

##### 3.11.4 请求示例
```json
{
  "dataType": "BROWSE_HISTORY",
  "password": "123456"
}
```

##### 3.11.5 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "数据删除成功",
  "data": {
    "deletedCount": 150
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.11.6 错误码
| 错误码 | 说明 |
|-------|------|
| 5104 | 隐私密码错误 |
| 5108 | 数据类型不支持 |
| 1121 | Token已过期 |

#### 3.12 设置双因素认证

##### 3.12.1 接口定义
```
PUT /api/v1.0/privacy/two-factor
```

##### 3.12.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.12.3 请求参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| enabled | boolean | 是 | 是否启用双因素认证 | true |
| method | string | 否 | 验证方式 | SMS/EMAIL/AUTHENTICATOR |

##### 3.12.4 请求示例
```json
{
  "enabled": true,
  "method": "SMS"
}
```

##### 3.12.5 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "双因素认证设置成功",
  "data": {
    "enabled": true,
    "method": "SMS"
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.12.6 错误码
| 错误码 | 说明 |
|-------|------|
| 5109 | 验证方式不支持 |
| 1121 | Token已过期 |

#### 3.13 获取登录设备列表

##### 3.13.1 接口定义
```
GET /api/v1.0/privacy/devices
```

##### 3.13.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.13.3 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "获取成功",
  "data": [
    {
      "deviceId": "device-123",
      "deviceName": "iPhone 15 Pro",
      "deviceType": "MOBILE",
      "os": "iOS 17.0",
      "ip": "192.168.1.1",
      "location": "广东省深圳市",
      "lastActive": "2026-02-03T10:00:00.000Z",
      "isCurrent": true
    },
    {
      "deviceId": "device-456",
      "deviceName": "MacBook Pro",
      "deviceType": "DESKTOP",
      "os": "macOS 14.0",
      "ip": "192.168.1.2",
      "location": "广东省广州市",
      "lastActive": "2026-02-02T15:00:00.000Z",
      "isCurrent": false
    }
  ],
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.13.4 错误码
| 错误码 | 说明 |
|-------|------|
| 1121 | Token已过期 |

#### 3.14 移除登录设备

##### 3.14.1 接口定义
```
DELETE /api/v1.0/privacy/devices/{deviceId}
```

##### 3.14.2 请求头
```http
Authorization: Bearer eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...
```

##### 3.14.3 路径参数

| 参数名 | 类型 | 必填 | 说明 | 示例 |
|-------|------|------|------|------|
| deviceId | string | 是 | 设备ID | device-123 |

##### 3.14.4 成功响应
```json
{
  "success": true,
  "code": 200,
  "message": "设备移除成功",
  "data": null,
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

##### 3.14.5 错误码
| 错误码 | 说明 |
|-------|------|
| 5110 | 设备不存在 |
| 5111 | 不能移除当前设备 |
| 1121 | Token已过期 |

### 4. 数据模型

#### 4.1 隐私设置模型

```typescript
interface PrivacySettings {
  privacyMode: 'STANDARD' | 'STEALTH' | 'DISGUISE';
  privacyModeText: string;
  disguiseShipping: boolean;
  disguiseType?: string;
  disguiseTypeText?: string;
  hasPrivacyPassword: boolean;
  appLockEnabled: boolean;
  twoFactorEnabled: boolean;
  autoClearHistory: boolean;
  autoClearDays?: number;
}
```

#### 4.2 安全日志模型

```typescript
interface SecurityLog {
  logId: string;
  logType: 'LOGIN' | 'LOGOUT' | 'SETTINGS' | 'PASSWORD_CHANGE';
  logTypeText: string;
  device: string;
  ip: string;
  location: string;
  status: 'SUCCESS' | 'FAILED';
  createdAt: string;
}
```

#### 4.3 登录设备模型

```typescript
interface LoginDevice {
  deviceId: string;
  deviceName: string;
  deviceType: 'MOBILE' | 'DESKTOP' | 'TABLET';
  os: string;
  ip: string;
  location: string;
  lastActive: string;
  isCurrent: boolean;
}
```

### 5. 最佳实践

#### 5.1 前端实现

##### 5.1.1 隐私模式切换
```typescript
// 切换隐私模式时显示确认弹窗
const handlePrivacyModeChange = async (mode) => {
  const confirmed = await showConfirmDialog(
    `切换到${mode === 'STEALTH' ? '隐身' : '伪装'}模式后，您的浏览记录将被隐藏，确认切换？`
  );
  
  if (confirmed) {
    await updatePrivacyMode({ privacyMode: mode });
    showToast('隐私模式切换成功');
  }
};
```

##### 5.1.2 应用锁验证
```typescript
// 进入敏感功能前验证应用锁
const checkAppLock = async () => {
  const settings = await getPrivacySettings();
  
  if (settings.appLockEnabled) {
    const verified = await showAppLockDialog();
    if (!verified) {
      throw new Error('应用锁验证失败');
    }
  }
  
  return true;
};
```

#### 5.2 后端实现

##### 5.2.1 隐私密码加密
```typescript
// 使用Argon2加密隐私密码
import * as argon2 from 'argon2';

const hashPrivacyPassword = async (password: string) => {
  return await argon2.hash(password, {
    type: argon2.argon2id,
    memoryCost: 65536,
    timeCost: 3,
    parallelism: 4
  });
};

const verifyPrivacyPassword = async (hash: string, password: string) => {
  return await argon2.verify(hash, password);
};
```

##### 5.2.2 安全日志记录
```typescript
// 记录安全操作日志
async function logSecurityEvent(userId, eventType, metadata) {
  await prisma.securityLog.create({
    data: {
      userId,
      eventType,
      device: metadata.device,
      ip: metadata.ip,
      location: metadata.location,
      status: metadata.status,
      createdAt: new Date()
    }
  });
}
```

### 6. 安全注意事项

#### 6.1 隐私密码安全
- 使用Argon2算法加密存储
- 不在日志中记录密码
- 限制密码验证尝试次数
- 支持密码重置功能

#### 6.2 数据加密
- 敏感数据使用AES-256加密
- 传输层使用TLS 1.3
- 支持端到端加密
- 定期轮换加密密钥

#### 6.3 访问控制
- 实现细粒度权限控制
- 支持匿名访问模式
- 记录所有访问日志
- 异常访问自动告警

#### 6.4 数据删除
- 支持用户自主删除数据
- 删除后无法恢复
- 备份数据同步删除
- 符合GDPR要求

## 附录

### A. 参考文档

- RESTful接口设计标准
- 接口错误码体系
- 接口签名鉴权手册
- YYC³项目规范文档

### B. 术语表

- GDPR：General Data Protection Regulation（通用数据保护条例）
- AES：Advanced Encryption Standard（高级加密标准）
- TLS：Transport Layer Security（传输层安全协议）
- Argon2：密码哈希算法

---

<div align="center">

> 「***YanYuCloudCube***」
> 「***<admin@0379.email>***」
> 「***Words Initiate Quadrants, Language Serves as Core for the Future***」
> 「***All things converge in the cloud pivot; Deep stacks ignite a new era of intelligence***」

</div>

---
file: 064-通用规范-接口错误码体系.md
description: HaiLan Pro 全局统一的接口错误码定义，包含业务码、技术码、错误描述规范
author: YanYuCloudCube Team
version: v1.0.0
created: 2026-02-03
updated: 2026-02-03
status: published
tags:
  - API接口,[通用规范],[错误码]
---

> ***YanYuCloudCube***
> **标语**：言启象限 | 语枢未来
> ***Words Initiate Quadrants, Language Serves as Core for Future***
> **标语**：万象归元于云枢 | 深栈智启新纪元
> ***All things converge in cloud pivot; Deep stacks ignite a new era of intelligence***

---

# 064 通用规范-接口错误码体系

## 概述

本文档详细描述HaiLan Pro项目全局统一的接口错误码定义，包含业务码、技术码、错误描述规范，确保项目按照YYC³标准规范进行开发和实施。

## 核心内容

### 1. 背景与目标

#### 1.1 项目背景
HaiLan Pro (海蓝) 是新一代高端、私密、智能的情趣健康生活管理平台。项目基于「五高五标五化」理念，通过 PWA 技术结合 AI 智能辅助与物联网，为用户提供从生理健康到心理愉悦的全方位解决方案。

#### 1.2 项目愿景
打造极致隐私、智能陪伴、品质合规、全场景覆盖的情趣健康生活管理平台，为用户提供安全、专业、高端的健康生活体验。

#### 1.3 核心价值主张
- **极致隐私**：双重加密、隐私浏览模式及伪装发货机制
- **智能陪伴**：基于 LLM 的 AI 情感与生理健康顾问
- **品质合规**：医疗级标准商品，高端"海蓝蓝"视觉调性
- **全场景覆盖**：PWA 端支持离线浏览、桌面安装及无缝推送

#### 1.4 文档目标
- 建立统一的接口错误码体系
- 规范错误码的命名、分类和使用
- 为前后端开发人员提供清晰的错误处理指导
- 保障错误信息的一致性和可追溯性

### 2. 错误码设计原则

#### 2.1 编码规则

##### 2.1.1 错误码格式
```
{业务域}{错误类型}{具体错误}
```

##### 2.1.2 编码说明
- **业务域**：1位数字，标识业务模块
  - 1：用户系统
  - 2：商城系统
  - 3：订单系统
  - 4：支付系统
  - 5：隐私中心
  - 6：AI系统
  - 7：IoT设备
  - 8：内容社区
  - 9：会员分销

- **错误类型**：1位数字，标识错误类别
  - 0：成功
  - 1：参数错误
  - 2：业务逻辑错误
  - 3：权限错误
  - 4：资源错误
  - 5：系统错误

- **具体错误**：2位数字，标识具体错误

#### 2.2 错误码分类

##### 2.2.1 HTTP状态码
| 状态码 | 说明 | 使用场景 |
|-------|------|---------|
| 200 | OK | 请求成功 |
| 201 | Created | 资源创建成功 |
| 204 | No Content | 删除成功，无返回内容 |
| 400 | Bad Request | 请求参数错误 |
| 401 | Unauthorized | 未授权 |
| 403 | Forbidden | 无权限 |
| 404 | Not Found | 资源不存在 |
| 422 | Unprocessable Entity | 业务逻辑错误 |
| 429 | Too Many Requests | 请求过于频繁 |
| 500 | Internal Server Error | 服务器内部错误 |
| 502 | Bad Gateway | 网关错误 |
| 503 | Service Unavailable | 服务不可用 |
| 504 | Gateway Timeout | 网关超时 |

##### 2.2.2 业务错误码
| 错误码 | HTTP码 | 说明 | 解决方案 |
|-------|-------|------|---------|
| 1000 | 400 | 参数缺失 | 检查请求参数完整性 |
| 1001 | 400 | 参数格式错误 | 检查参数格式是否正确 |
| 1002 | 400 | 参数值超出范围 | 检查参数值是否在允许范围内 |
| 1003 | 400 | 必填参数为空 | 填写必填参数 |

### 3. 业务域错误码

#### 3.1 用户系统错误码 (1xxxx)

| 错误码 | HTTP码 | 错误类型 | 错误描述 | 解决方案 |
|-------|-------|---------|---------|---------|
| 1100 | 400 | 参数错误 | 用户名格式错误 | 检查用户名格式 |
| 1101 | 400 | 参数错误 | 邮箱格式错误 | 检查邮箱格式 |
| 1102 | 400 | 参数错误 | 手机号格式错误 | 检查手机号格式 |
| 1103 | 400 | 参数错误 | 密码格式错误 | 密码需8-20位，包含字母和数字 |
| 1120 | 401 | 权限错误 | 用户名或密码错误 | 检查用户名和密码 |
| 1121 | 401 | 权限错误 | Token已过期 | 重新登录获取新Token |
| 1122 | 401 | 权限错误 | Token无效 | 检查Token是否正确 |
| 1130 | 409 | 业务逻辑错误 | 用户已存在 | 使用其他用户名注册 |
| 1131 | 404 | 资源错误 | 用户不存在 | 检查用户ID是否正确 |
| 1132 | 403 | 权限错误 | 用户已被禁用 | 联系客服解禁账号 |
| 1140 | 422 | 业务逻辑错误 | 验证码错误 | 检查验证码是否正确 |
| 1141 | 422 | 业务逻辑错误 | 验证码已过期 | 重新获取验证码 |

#### 3.2 商城系统错误码 (2xxxx)

| 错误码 | HTTP码 | 错误类型 | 错误描述 | 解决方案 |
|-------|-------|---------|---------|---------|
| 2100 | 400 | 参数错误 | 商品ID格式错误 | 检查商品ID格式 |
| 2101 | 400 | 参数错误 | 分类ID格式错误 | 检查分类ID格式 |
| 2120 | 404 | 资源错误 | 商品不存在 | 检查商品ID是否正确 |
| 2121 | 404 | 资源错误 | 分类不存在 | 检查分类ID是否正确 |
| 2130 | 422 | 业务逻辑错误 | 商品库存不足 | 选择其他商品或等待补货 |
| 2131 | 422 | 业务逻辑错误 | 商品已下架 | 选择其他商品 |
| 2132 | 422 | 业务逻辑错误 | 商品规格无效 | 选择有效的商品规格 |
| 2140 | 403 | 权限错误 | 无权限访问商品 | 检查商品访问权限 |

#### 3.3 订单系统错误码 (3xxxx)

| 错误码 | HTTP码 | 错误类型 | 错误描述 | 解决方案 |
|-------|-------|---------|---------|---------|
| 3100 | 400 | 参数错误 | 订单ID格式错误 | 检查订单ID格式 |
| 3120 | 404 | 资源错误 | 订单不存在 | 检查订单ID是否正确 |
| 3130 | 422 | 业务逻辑错误 | 订单已支付 | 无需重复支付 |
| 3131 | 422 | 业务逻辑错误 | 订单已取消 | 无法操作已取消的订单 |
| 3132 | 422 | 业务逻辑错误 | 订单已完成 | 无法操作已完成的订单 |
| 3133 | 422 | 业务逻辑错误 | 订单状态不允许此操作 | 检查订单状态 |
| 3140 | 403 | 权限错误 | 无权限访问订单 | 检查订单访问权限 |
| 3150 | 422 | 业务逻辑错误 | 购物车为空 | 添加商品到购物车 |
| 3151 | 422 | 业务逻辑错误 | 商品数量超出限制 | 减少购买数量 |

#### 3.4 支付系统错误码 (4xxxx)

| 错误码 | HTTP码 | 错误类型 | 错误描述 | 解决方案 |
|-------|-------|---------|---------|---------|
| 4100 | 400 | 参数错误 | 支付金额错误 | 检查支付金额是否正确 |
| 4101 | 400 | 参数错误 | 支付方式错误 | 选择有效的支付方式 |
| 4120 | 422 | 业务逻辑错误 | 支付已处理 | 无需重复支付 |
| 4121 | 422 | 业务逻辑错误 | 支付已取消 | 重新发起支付 |
| 4122 | 422 | 业务逻辑错误 | 支付超时 | 重新发起支付 |
| 4130 | 500 | 系统错误 | 支付系统异常 | 联系客服处理 |
| 4131 | 500 | 系统错误 | 第三方支付失败 | 检查支付账户或联系客服 |

#### 3.5 隐私中心错误码 (5xxxx)

| 错误码 | HTTP码 | 错误类型 | 错误描述 | 解决方案 |
|-------|-------|---------|---------|---------|
| 5100 | 400 | 参数错误 | 隐私模式参数错误 | 检查隐私模式参数 |
| 5120 | 403 | 权限错误 | 无权限修改隐私设置 | 检查权限设置 |
| 5130 | 422 | 业务逻辑错误 | 隐私模式设置失败 | 重试设置隐私模式 |
| 5140 | 422 | 业务逻辑错误 | 生物识别失败 | 重新进行生物识别 |
| 5141 | 422 | 业务逻辑错误 | 生物识别未启用 | 在设置中启用生物识别 |

#### 3.6 AI系统错误码 (6xxxx)

| 错误码 | HTTP码 | 错误类型 | 错误描述 | 解决方案 |
|-------|-------|---------|---------|---------|
| 6100 | 400 | 参数错误 | 对话内容为空 | 输入对话内容 |
| 6101 | 400 | 参数错误 | 对话内容过长 | 缩短对话内容 |
| 6120 | 500 | 系统错误 | AI服务不可用 | 稍后重试 |
| 6121 | 500 | 系统错误 | AI响应超时 | 稍后重试 |
| 6130 | 429 | 系统错误 | AI调用次数超限 | 等待冷却时间后重试 |

#### 3.7 IoT设备错误码 (7xxxx)

| 错误码 | HTTP码 | 错误类型 | 错误描述 | 解决方案 |
|-------|-------|---------|---------|---------|
| 7100 | 400 | 参数错误 | 设备ID格式错误 | 检查设备ID格式 |
| 7101 | 400 | 参数错误 | 设备类型错误 | 选择有效的设备类型 |
| 7120 | 404 | 资源错误 | 设备不存在 | 检查设备ID是否正确 |
| 7130 | 422 | 业务逻辑错误 | 设备已绑定 | 解除旧设备绑定后再绑定 |
| 7131 | 422 | 业务逻辑错误 | 设备连接失败 | 检查设备连接状态 |
| 7140 | 403 | 权限错误 | 无权限操作设备 | 检查设备操作权限 |

#### 3.8 内容社区错误码 (8xxxx)

| 错误码 | HTTP码 | 错误类型 | 错误描述 | 解决方案 |
|-------|-------|---------|---------|---------|
| 8100 | 400 | 参数错误 | 内容ID格式错误 | 检查内容ID格式 |
| 8101 | 400 | 参数错误 | 评论内容为空 | 输入评论内容 |
| 8120 | 404 | 资源错误 | 内容不存在 | 检查内容ID是否正确 |
| 8130 | 422 | 业务逻辑错误 | 内容已发布 | 无需重复发布 |
| 8131 | 422 | 业务逻辑错误 | 内容审核中 | 等待审核结果 |
| 8132 | 422 | 业务逻辑错误 | 内容审核不通过 | 修改内容后重新提交 |

#### 3.9 会员分销错误码 (9xxxx)

| 错误码 | HTTP码 | 错误类型 | 错误描述 | 解决方案 |
|-------|-------|---------|---------|---------|
| 9100 | 400 | 参数错误 | 推广码格式错误 | 检查推广码格式 |
| 9120 | 404 | 资源错误 | 推广码不存在 | 检查推广码是否正确 |
| 9130 | 422 | 业务逻辑错误 | 推广码已使用 | 使用其他推广码 |
| 9131 | 422 | 业务逻辑错误 | 推广码已过期 | 使用有效的推广码 |
| 9140 | 403 | 权限错误 | 无权限使用推广码 | 检查推广码使用权限 |

### 4. 技术错误码

#### 4.1 系统错误码 (50000-50999)

| 错误码 | HTTP码 | 错误类型 | 错误描述 | 解决方案 |
|-------|-------|---------|---------|---------|
| 50000 | 500 | 系统错误 | 服务器内部错误 | 联系技术支持 |
| 50001 | 500 | 系统错误 | 数据库连接失败 | 联系技术支持 |
| 50002 | 500 | 系统错误 | 数据库查询失败 | 联系技术支持 |
| 50003 | 500 | 系统错误 | 缓存服务失败 | 联系技术支持 |
| 50004 | 500 | 系统错误 | 消息队列失败 | 联系技术支持 |
| 50005 | 500 | 系统错误 | 文件存储失败 | 联系技术支持 |

#### 4.2 网络错误码 (51000-51999)

| 错误码 | HTTP码 | 错误类型 | 错误描述 | 解决方案 |
|-------|-------|---------|---------|---------|
| 51000 | 502 | 网络错误 | 网关错误 | 稍后重试 |
| 51001 | 503 | 网络错误 | 服务不可用 | 稍后重试 |
| 51002 | 504 | 网络错误 | 网关超时 | 稍后重试 |
| 51003 | 429 | 网络错误 | 请求过于频繁 | 降低请求频率 |

### 5. 错误响应格式

#### 5.1 标准错误响应

```json
{
  "success": false,
  "code": 1100,
  "message": "用户名格式错误",
  "error": {
    "type": "VALIDATION_ERROR",
    "field": "username",
    "details": "用户名长度需为4-20位，只能包含字母、数字和下划线"
  },
  "timestamp": "2026-02-03T10:00:00.000Z",
  "requestId": "550e8400-e29b-41d4-a716-446655440001"
}
```

#### 5.2 错误响应字段说明

| 字段名 | 类型 | 必填 | 说明 |
|-------|------|------|------|
| success | boolean | 是 | 请求是否成功，始终为false |
| code | integer | 是 | 错误码 |
| message | string | 是 | 错误描述，用户友好的错误信息 |
| error | object | 否 | 错误详细信息对象 |
| error.type | string | 否 | 错误类型 |
| error.field | string | 否 | 错误字段名 |
| error.details | string | 否 | 错误详细信息 |
| timestamp | string | 是 | 错误发生时间，ISO 8601格式 |
| requestId | string | 是 | 请求唯一标识，用于问题追踪 |

### 6. 错误处理最佳实践

#### 6.1 前端错误处理

##### 6.1.1 统一错误拦截
```typescript
// 拦截所有API错误
apiClient.interceptors.response.use(
  (response) => response,
  (error) => {
    const { code, message } = error.response.data;
    
    // 根据错误码处理
    switch (code) {
      case 1120:
        showError('用户名或密码错误');
        break;
      case 1121:
        showError('登录已过期，请重新登录');
        redirectToLogin();
        break;
      default:
        showError(message || '操作失败，请稍后重试');
    }
    
    return Promise.reject(error);
  }
);
```

##### 6.1.2 错误提示
- 使用Toast组件显示错误信息
- 错误信息简洁明了
- 提供解决方案建议
- 支持错误信息复制

#### 6.2 后端错误处理

##### 6.2.1 统一异常处理
```typescript
// 全局异常处理器
@Catch()
export class GlobalExceptionFilter implements ExceptionFilter {
  catch(exception: any, host: ArgumentsHost) {
    const ctx = host.switchToHttp();
    const response = ctx.getResponse();
    
    let code = 50000;
    let message = '服务器内部错误';
    
    if (exception instanceof BusinessException) {
      code = exception.code;
      message = exception.message;
    }
    
    return response.status(200).json({
      success: false,
      code,
      message,
      timestamp: new Date().toISOString(),
      requestId: this.getRequestId(ctx)
    });
  }
}
```

##### 6.2.2 错误日志记录
- 记录完整错误堆栈
- 记录请求上下文
- 记录用户信息（脱敏）
- 记录错误发生时间

### 7. 错误监控与告警

#### 7.1 错误监控指标

| 指标名 | 说明 | 告警阈值 |
|-------|------|---------|
| 错误率 | 错误请求数/总请求数 | > 5% |
| 5xx错误率 | 5xx错误数/总请汽数 | > 1% |
| 4xx错误率 | 4xx错误数/总请求数 | > 3% |
| 特定错误码频率 | 单个错误码出现次数 | > 100次/分钟 |

#### 7.2 告警规则

- 错误率超过阈值时发送告警
- 5xx错误超过阈值时立即告警
- 特定错误码高频出现时告警
- 告警发送到技术团队

### 8. 错误码维护

#### 8.1 新增错误码

- 评估错误码必要性
- 选择合适的业务域
- 选择合适的错误类型
- 分配具体的错误编号
- 更新错误码文档
- 通知前后端开发人员

#### 8.2 废弃错误码

- 标记为deprecated
- 保留至少3个版本
- 提供替换错误码
- 更新相关代码
- 更新错误码文档

#### 8.3 错误码版本管理

- 每个版本维护错误码变更记录
- 记录新增、修改、废弃的错误码
- 提供迁移指南
- 保持向后兼容性

## 附录

### A. 参考文档

- HTTP状态码规范
- RESTful API设计最佳实践
- YYC³项目规范文档
- 前端错误处理规范
- 后端异常处理规范

### B. 术语表

- HTTP：HyperText Transfer Protocol
- API：Application Programming Interface
- JWT：JSON Web Token
- DID：Decentralized Identity
- PWA：Progressive Web App
- IoT：Internet of Things

### C. 错误码速查表

| 错误类型 | 错误码范围 | 说明 |
|---------|------------|------|
| 成功 | 0 | 请求成功 |
| 参数错误 | 1xxx | 请求参数错误 |
| 业务逻辑错误 | 2xxx | 业务逻辑错误 |
| 权限错误 | 3xxx | 权限不足 |
| 资源错误 | 4xxx | 资源不存在 |
| 系统错误 | 5xxx | 系统内部错误 |

---

<div align="center">

> 「***YanYuCloudCube***」
> 「***<admin@0379.email>***」
> 「***Words Initiate Quadrants, Language Serves as Core for Future***」
> 「***All things converge in cloud pivot; Deep stacks ignite a new era of intelligence***」

</div>
